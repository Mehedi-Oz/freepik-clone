# Pixahunt / Freepik-clone — Project Documentation

This document is a comprehensive guide to the `freepik-clone` (aka Pixahunt) repository: architecture, setup, development workflow, build steps, API notes, and contribution guidelines.

---

**Project Summary**

- **Name**: Pixahunt (Freepik clone)
- **Purpose**: A high-fidelity stock photo discovery platform with advanced filtering and search, built using PHP (backend) and vanilla JS + Tailwind (frontend).
- **Primary audience**: Developers who want to run, extend or contribute to the project locally and deploy to a PHP+MySQL environment.

---

**Tech Stack**

- Backend: PHP 8.0+ (plain PHP, no framework)
- Database: MySQL (connects through `database/db.php`)
- Frontend: HTML, Vanilla JavaScript (ES6), Tailwind CSS
- Build tools: `postcss`, `esbuild`, `npm` scripts defined in `package.json`

Note: This project compiles Tailwind locally using PostCSS + Tailwind CLI (configured via `postcss.config.js` and `tailwind.config.js`). It does NOT rely on the Tailwind CDN; CSS is generated during the build step and served from `dist/`.

---

**Repository Layout (key files and folders)**

- `public/` — Public web root used by the router. Contains `index.php` and `api.php`.
- `src/` — Application source code:
  - `src/classes/` — PHP classes: `Repository.php`, `ImageRepository.php`, `ImageService.php`, `Cache.php`.
  - `src/api/search_logic.php` — server-side search business logic used by the API.
  - `src/templates/` — PHP templates such as `image-card.php` used to render image cards.
  - `src/css/` — Source Tailwind CSS input: `input.css`, `style.css`.
  - `src/js/` — Frontend JS entry: `script.js`.
  - `src/helpers/asset.php` — helper functions for assets.
- `includes/` — Shared HTML parts: `head.php`, `header.php`, `sidebar.php`, `footer.php` used by pages.
- `config/` — Configuration files; `config.php` contains app-level configuration.
- `database/` — DB connection examples: `db.example.php` and `db.php` (ignored by Git via `.gitignore`).
- `scripts/` — Node scripts: `optimize-assets.js`, `hash-assets.js` used in production build pipeline.
- `dist/` — Distribution output (compiled CSS/JS) — usually generated by `npm run build`.
- `assets/` — Static assets (logos, images).
- `.github/` — CI and project instructions.

---

**Important entry points**

- `public/index.php` — main entry; routing for browser requests goes through here (see `.htaccess` rules which direct traffic to `public/index.php`).
- `public/api.php` — API endpoint for AJAX and search requests.
- `src/api/search_logic.php` — implements search logic used by `public/api.php` (server-side filtering, pagination, ranking).

---

Development Setup (Windows + XAMPP)

1. Install XAMPP (or equivalent) and ensure Apache + MySQL are running.
2. Clone repository into your webserver root. Example for XAMPP on Windows:

```
# If using PowerShell and XAMPP htdocs is C:\xampp\htdocs
cd C:\xampp\htdocs
git clone <repo-url> freepik-clone
```

3. Ensure PHP 8.0+ is available (XAMPP includes PHP; `.htaccess` sets handler to ea-php80 in the hosted environment). If your local PHP differs, update Apache/PHP configuration accordingly.
4. Create your database and copy `database/db.example.php` to `database/db.php` and fill credentials.

5. Install Node dev dependencies (for building CSS/JS):

```
cd C:\xampp\htdocs\freepik-clone
npm install
```

6. Start the build/watchers while developing:

```
# In PowerShell: run watchers (two background processes are combined in package.json watch script)
npm run watch

# Or run them individually
npm run watch-css
npm run watch-js
```

7. Serve the app through Apache by visiting `http://localhost/freepik-clone/` (or your configured virtual host). The repo's `index.php` redirects to `public/index.php`.

---

Build & Production

- Build CSS and JS, then optimize & hash assets for production:

```
npm run build-prod
```

- This runs `build` then `optimize-assets` and `hash-assets` (see `scripts/`), producing fingerprinted assets in `dist/`.

---

NPM scripts (quick reference from `package.json`)

- `npm run build` — builds CSS and JS (`build-css` + `build-js`).
- `npm run build-css` — `postcss src/css/input.css -o dist/output.css` (Tailwind + autoprefixer).
- `npm run build-js` — `esbuild` bundles `src/js/script.js`.
- `npm run build-prod` — `build` + `optimize-assets` + `hash-assets`.
- `npm run watch` — watch CSS and JS during development.
- `npm run lint` — run `eslint` on JS sources.
- `npm run format` — run `prettier` across codebase.

---

Backend summary — PHP classes

- `Repository.php` — Base repository patterns / data access helpers.
- `ImageRepository.php` — Data access for images (DB queries, filters, pagination).
- `ImageService.php` — Business logic for image operations (likely uses `ImageRepository`).
- `Cache.php` — Simple caching wrapper (file or memory) used to reduce DB load for repeated queries.

Note: These classes are small, plain PHP and follow a repository/service separation. If you extend them, prefer single-responsibility and add unit tests if possible.

---

API & Search

- `public/api.php` — main API endpoint. It accepts AJAX requests (search, filters, pagination) and delegates to `src/api/search_logic.php`.
- `src/api/search_logic.php` — contains the search/filter logic, sanitizes inputs and returns JSON (or HTML fragments depending on endpoints).

Guidance: Treat any query parameters as untrusted. Existing code should use prepared statements via your DB layer — if it does not, implement parameterized queries to avoid SQL injection.

---

Frontend

- `src/js/script.js` provides client-side search controls, AJAX requests to `public/api.php`, lazy-loading, and UI behaviors.
- `src/templates/image-card.php` renders a single image card server-side; the frontend inserts these HTML fragments when loading more images.

- Tailwind usage: Tailwind is built into the project's CSS during the `build-css` step (`postcss src/css/input.css -o dist/output.css`). Use `npm run watch-css` during development to rebuild on changes. The `tailwind.config.js` defines the `content` paths used for purging unused styles.

---

Security & Environment

- `database/db.php` is ignored by Git; keep DB credentials out of source control.
- Use environment variables or protected config files for secrets (DB credentials, API keys). Consider `dotenv` or server-level env vars.
- Recommended HTTP headers: use a security middleware or set headers in `includes/head.php` or `public/index.php`:
  - `Content-Security-Policy` (CSP)
  - `X-Frame-Options: SAMEORIGIN`
  - `Strict-Transport-Security` (HSTS) in production

---

Testing & Quality

- There are no automated tests included. Start by adding unit tests for PHP using PHPUnit and JS tests with a lightweight runner if needed.
- Use `npm run lint` and `npm run format` to maintain code quality.

---

Troubleshooting

- If pages are blank: check Apache/PHP error logs and enable display_errors in a dev environment.
- DB issues: verify `database/db.php` credentials and that the DB schema exists.
- Asset issues: run `npm run build` and ensure `dist/` files are available and paths in templates reference `dist/` correctly.

---

Contribution guidelines

- Fork, create a feature branch, submit a PR against `main`.
- Keep commits small and focused. Follow the project's coding standards in `.github/instructions` (SOLID, secure-by-default).
- Run `npm run lint` and `npm run format` before opening PRs.

---

Suggested Next Steps (for maintainers)

1. Add a `CONTRIBUTING.md` with PR and code review rules.
2. Add basic PHPUnit tests for the `ImageService` and DB queries.
3. Document the database schema (migrations or a SQL file) so contributors can replicate DB locally.
4. Add a `docker-compose.yml` for consistent developer environments (optional).

---

If you'd like, I can:

- Extract this into smaller docs under `docs/` (setup, architecture, API) for easier navigation.
- Add a `CONTRIBUTING.md` and `DEVELOPMENT.md` with exact dev steps and typical workflows.
- Create a sample `.env.example` and update `database/db.php` to use environment variables.

---

Files created:

- `DOCUMENTATION.md` (this file)

Thank you — tell me which follow-up you'd like first (split docs, CONTRIBUTING.md, tests, or docker setup).
